name: Cloudflare DNS with Curl

on: [push]

jobs:
  update-dns:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Update Cloudflare DNS
      run: |
        # Replace placeholders with your actual values
        CF_API_TOKEN="YOUR_CLOUDFLARE_API_TOKEN"
        ZONE_ID="YOUR_ZONE_ID"
        RECORD_NAME="subdomain"
        RECORD_TYPE="A"
        RECORD_CONTENT="IPv4_address"
        TTL=3600
        DNS_COMMENT="Updating DNS record using GitHub Actions"

        # Construct the API URL
        API_URL="https://api.cloudflare.com/client/v4/zones/$ZONE_ID/dns_records"
        
        # Create or update the DNS record
        curl -X POST "$API_URL" \
             -H "Authorization: Bearer $CF_API_TOKEN" \
             -H "Content-Type: application/json" \
             --data '{
               "type": "'$RECORD_TYPE'",
               "name": "'$RECORD_NAME'",
               "content": "'$RECORD_CONTENT'",
               "ttl": '$TTL',
               "comments": "'$DNS_COMMENT'"
             }'
      env:
        CF_API_TOKEN: ${{ secrets.CLOUDFLARE_API_TOKEN }}  # Access token stored as a secret
